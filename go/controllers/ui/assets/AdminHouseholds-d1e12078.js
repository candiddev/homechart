import{S as l,D as u,A as d,c as a,W as y,E as H,m as s,G as g,H as I,F as o,J as c,K as n,L as v,M as A,N as D,P as x,r as W,t as b,x as P,b as S,Q as $,R as O,T as p,y as T,U as C,I as f,B as m,a as E,C as F}from"./index-09c2e996.js";import{F as G}from"./Filter-01c23926.js";import{G as L}from"./GetHelp-610c77dd.js";function M(){const e={authHouseholds:l([]),columns:l({id:"",countMembers:"",created:"",subscriptionExpires:"",subscriptionProcessor:""}),filter:"",form:{data:u.new(),visible:!1},loaded:!1,page:1,total:0};async function i(){let t=0;return e.page!==1&&(t=(e.page-1)*50),e.loaded=!1,u.readAdmin(e.filter,t).then(r=>{F(r)||(e.authHouseholds(r.dataValue),e.total=r.dataTotal,e.loaded=!0,s.redraw())})}d.getSessionDisplay()<=1&&e.columns({id:"",subscriptionProcessor:""});const h=l.lift((t,r)=>G.array(t,r,{}),e.authHouseholds,e.columns);return{oninit:async()=>(e.loaded=!1,d.setLayoutApp({...L(),breadcrumbs:[{name:a.translate(y)},{name:a.translate(H)}],toolbarActionButtons:[]}),s.route.param().filter!==void 0&&(e.filter=s.route.param().filter),s.route.param().page!==void 0&&(e.page=parseInt(s.route.param().page,10)),i().then(()=>{e.loaded=!0})),view:()=>[e.form.visible?s(S,{buttons:[{name:a.translate(W),onclick:async()=>new Promise(t=>(e.form.visible=!1,t())),permitted:!0,requireOnline:!1},{name:a.translate(b),permitted:!0,requireOnline:!0,submit:!0}],onsubmit:async()=>u.update(e.form.data).then(async()=>(e.form.visible=!1,i())),overlay:!0,title:{name:`${a.translate(b)} ${a.translate(P)}`}},[s(g,{name:a.translate(I),oninput:t=>{e.form.data.subscriptionExpires=t},required:!0,tooltip:"",value:e.form.data.subscriptionExpires}),s(o,{name:a.translate(c),select:{oninput:t=>{e.form.data.subscriptionProcessor=n.subscriptionProcessors.indexOf(t)},options:n.subscriptionProcessors,required:!0,value:n.subscriptionProcessors[e.form.data.subscriptionProcessor]},tooltip:""}),s(o,{input:{oninput:t=>{e.form.data.subscriptionCustomerID=t},type:"text",value:e.form.data.subscriptionCustomerID},name:a.translate(v),tooltip:""}),s(o,{input:{oninput:t=>{e.form.data.subscriptionID=t},type:"text",value:e.form.data.subscriptionID},name:a.translate(A),tooltip:""}),s(o,{input:{oninput:t=>{e.form.data.subscriptionLastTransactionID=t},type:"text",value:e.form.data.subscriptionLastTransactionID},name:a.translate(D),tooltip:""}),s(o,{input:{oninput:t=>{e.form.data.selfHostedID=t},type:"text",value:e.form.data.selfHostedID},name:a.translate(x),tooltip:""})]):[],s(E,{actions:[],data:h(),editOnclick:t=>{e.form.data=t,e.form.visible=!0},filters:[],loaded:e.loaded,search:{onsearch:async t=>(e.filter=t,i()),placeholder:a.translate($)},tableColumns:[{name:"ID",property:"id"},{linkFormatter:t=>`/admin/accounts?filter=${t.id}`,name:a.translate(O),property:"countMembers",type:p.Link},{name:a.translate(T),property:"created",type:p.Timestamp},{name:a.translate(C),property:"subscriptionExpires",type:p.Date},{formatter:t=>n.subscriptionProcessors[t.subscriptionProcessor],name:a.translate(c),property:"subscriptionProcessor"}],tableColumnsNameEnabled:e.columns,title:{buttonLeft:e.page===1?void 0:{href:`/admin/households?page=${e.page-1}`,icon:f.Previous,iconOnly:!0,name:"previous",permitted:!0,requireOnline:!0},buttonRight:e.page*50>e.total?void 0:{href:`/admin/households?page=${e.page+1}`,icon:f.Next,iconOnly:!0,name:"next",permitted:!0,requireOnline:!0},name:e.authHouseholds().length===0?`0 - 0 ${a.translate(m)} 0`:e.page===1?`1 - ${e.authHouseholds().length} ${a.translate(m)} ${e.total}`:`${50*(e.page-1)+1} - ${50*(e.page-1)+e.authHouseholds().length} ${a.translate(m)} ${e.total}`}})]}}export{M as AdminHouseholds};
