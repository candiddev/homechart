import{S as p,A as o,a0 as d,m as n,dj as s,c as r,ds as b,hO as h,ab as D,ed as m,az as l,aZ as f,af as I,dk as g,aN as C,T as u,ax as c,dl as x,hP as k,a as w,aY as A,hQ as F,a8 as O,ah as P,ai as T,b2 as S}from"./index-09c2e996.js";import{F as N}from"./Filter-01c23926.js";import{T as L}from"./TableColumnHousehold-f6fe7c15.js";import{G as j}from"./GetHelp-610c77dd.js";function v(){const a=l.now();return{view:e=>n("div.TableData__buttons",[n("span",o.formatCivilDate(e.attrs.nextDate)),l.fromString(`${e.attrs.nextDate}`)>a?n(A,{accent:!0,name:r.translate(F),onclick:async()=>{const t=O(e.attrs);return t.nextDate=l.now().toJSON(),s.update(t)},permitted:P.permitted(T.Shop,!0,e.attrs.authHouseholdID),requireOnline:!0}):[]])}}function W(){const a={columns:p({name:"",nextDate:""}),sort:p({invert:!1,property:"nextDate"})};o.getSessionDisplay()>=d.Small&&a.columns({name:"",budgetPayeeID:"",shopCategoryID:"",nextDate:""});let e;return{oninit:async()=>{S.spanStart("ShopStaples"),e=p.lift((t,i,y)=>(n.redraw(),N.array(t,i,y)),s.getStaples(),a.columns,a.sort),o.setLayoutApp({...j("shop"),breadcrumbs:[{link:"/shop/items",name:r.translate(b)},{name:r.translate(h)}],toolbarActionButtons:[{...D().newShopItem,onclick:()=>{o.setLayoutAppForm(m,{...s.new(),nextDate:l.now().toJSON(),recurrence:f.new()})}}]}),S.spanEnd("ShopStaples")},onremove:()=>{e.end(!0)},view:()=>n(w,{actions:[],data:e(),editOnclick:t=>{o.setLayoutAppForm(m,t)},filters:[],loaded:s.isLoaded(),sort:a.sort,tableColumns:[{name:r.translate(I),noFilter:!0,property:"name"},{formatter:t=>g.findID(t.shopCategoryID).name,name:r.translate(C),noFilter:!0,property:"shopCategoryID",type:u.Link},{formatter:t=>c.findID(t.budgetPayeeID).name,linkFormatter:t=>`/shop/items?store=${c.findID(t.budgetPayeeID).shortID}`,name:r.translate(x),noFilter:!0,property:"budgetPayeeID",type:u.Link},{name:r.translate(k),noFilter:!0,property:"nextDate",render:v},L()],tableColumnsNameEnabled:a.columns})}}export{W as ShopStaples};
