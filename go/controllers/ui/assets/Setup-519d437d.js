import{c as t,D as o,a8 as n,m as e,h1 as r,h2 as i,x as l,v as c,o as m,F as h,af as d,cf as b,ah as H,ai as A,ew as g,h3 as S,h4 as f,h5 as p,A as s,aU as y,h6 as D,h7 as w,b as $}from"./index-09c2e996.js";import{F as k,a as F}from"./FormTableAuthHouseholdMembers-b8ed5d57.js";import{F as W}from"./FormAuthAccountPreferences-03eff0ee.js";import{F as v}from"./FormJoinHousehold-1bb931f6.js";import{F as I}from"./FormSubscription-0bb20cc1.js";import"./Filter-01c23926.js";import"./AuthAccountAuthHousehold-a53b69dd.js";import"./FormPermissions-29833505.js";import"./Payment-7ef1bf2a.js";import"./TitleTabsAuthHouseholds-59423851.js";const L=()=>{const a={authAccount:t.data(),authHousehold:o.findID(t.data().primaryAuthHouseholdID)};return o.data.map(()=>{a.authHousehold=n(o.findID(t.data().primaryAuthHouseholdID))}),{oninit:async()=>{switch(e.route.param().target){case"account":document.title=`Homechart - ${t.translate(r)} ${t.translate(c)}`;break;case"household":document.title=`Homechart - ${t.translate(r)} ${t.translate(l)}`;break;case"subscription":document.title=`Homechart - ${t.translate(r)} ${t.translate(i)}`;break;default:document.title=`Homechart - ${t.translate(r)}`}},onremove:async()=>t.load().then(()=>{e.redraw()}),view:()=>e($,{buttons:[{name:t.translate(p),onclick:async()=>{if(s.redirect(),!t.data().setup)return t.update({...t.data(),setup:!0},!0)},permitted:!t.isDemo()&&!t.data().child&&e.route.param().target!=="subscription"||t.isDemo()&&e.route.param().target!=="household"||t.data().child&&e.route.param().target!=="account",requireOnline:!0},{name:t.isDemo()&&e.route.param().target==="household"||t.data().child&&e.route.param().target==="account"||e.route.param().target==="subscription"?t.translate(p):t.translate(y),permitted:!0,requireOnline:!0,submit:!0}],onsubmit:async()=>{switch(e.route.param().target){case"account":await t.update(a.authAccount,!0),t.data().child?s.redirect():e.route.set("/setup/household",{},{state:{key:Date.now()}});break;case"household":if(o.data().length===0){s.setLayoutAppAlert({message:t.translate(D)});return}if(await o.update(a.authHousehold,!0),!t.isDemo()){t.data().setup||await t.update({...t.data(),setup:!0},!0),e.route.set("/setup/subscription",{},{state:{key:Date.now()}});break}case"subscription":return s.redirect(),t.update({...t.data(),setup:!0},!0);default:e.route.set("/setup/account",{},{state:{key:Date.now()}});break}},progressCurrent:e.route.param().target==="account"?1:e.route.param().target==="household"?2:e.route.param().target==="subscription"?3:0,progressSteps:[{link:"/setup",name:t.translate(w)},{link:"/setup/account",name:`1 - ${t.translate(r)} ${t.translate(c)}`},...t.data().child?[]:[{link:"/setup/household",name:`2 - ${t.translate(r)} ${t.translate(l)}`}],...t.isDemo()||t.data().child?[]:[{disabled:o.data().length===0,link:"/setup/subscription",name:`3 - ${t.translate(r)} ${t.translate(i)}`}]]},e.route.param().target==="account"?e(W,{authAccount:a.authAccount}):e.route.param().target==="household"?m.data().permissionsHouseholds===null||m.data().permissionsHouseholds.length===0?e(v,{add:!0,onjoin:u=>{a.authHousehold=n(u),e.redraw()}}):[e(h,{input:{oninput:u=>{a.authHousehold.name=u},type:"text",value:a.authHousehold.name},name:t.translate(d),tooltip:t.translate(b)}),e(k,{oninput:u=>{a.authHousehold.preferences.currency=u},permitted:H.permitted(A.Auth,!0,a.authHousehold.id),value:a.authHousehold.preferences.currency}),e(F,{authHouseholdID:t.data().primaryAuthHouseholdID,nameEmailOnly:!0})]:e.route.param().target==="subscription"?e(I,{authHouseholdID:t.data().primaryAuthHouseholdID}):e("div.Setup#welcome",[e(g,{noTitle:!0}),e("p.Setup__welcome",`${t.translate(S)} Homechart`),e("p.Setup__overview",t.translate(f))]))}};export{L as Setup};
