import{S as n,fb as u,m as s,fe as l,A as i,c as o,fc as A,ak as D,ab as I,ff as T,I as m,fg as v,fd as w,ah as O,ai as V,ad as k,fh as F,af as L,fi as C,T as G,a as P,am as W}from"./index-09c2e996.js";import{F as x}from"./Filter-01c23926.js";import{T as E}from"./TableColumnHousehold-f6fe7c15.js";import{G as H}from"./GetHelp-610c77dd.js";function U(){const a={columns:n({name:"",Username:"",Password:"",URL:""}),search:n(""),sort:n({invert:!1,property:"name"}),tag:n(""),vault:u.new(),vaultID:n("all")};let c,d;function h(){return{view:e=>s("div",{style:{"align-items":"flex-start",display:"flex","flex-direction":"column"}},[s("div",[e.attrs.name,s(W,{icon:m.Tag,name:"tags",onclick:t=>{a.tag()===t?a.tag(""):a.tag(t)},selected:()=>[a.tag()],small:!0,value:e.attrs.tags})])])}}return{oninit:async()=>{c=n.lift((e,t,f,y,p,b)=>(s.redraw(),x.array(Object.keys(e).map(r=>({...l.findID(r),authHouseholdID:e[r].authHouseholdID,data:e[r].data,name:e[r].name,tags:e[r].tags})).filter(r=>{let g=`name=${r.name}`;return r.data.length>0&&Object.keys(r.data[0]).map(S=>{g+=` ${S}=${r.data[0][S]}`}),(b==="all"||r.secretsVaultID===b)&&(p===""||r.tags.includes(p))&&(f===""||g.toLowerCase().includes(f.toLowerCase()))}),t,y)),l.values,a.columns,a.search,a.sort,a.tag,a.vaultID),d=n.lift((e,t)=>{t!=="all"&&(a.vault=u.findID(t)),i.setLayoutApp({...H("secrets"),breadcrumbs:[{link:"/secrets",name:o.translate(A)},{name:a.vault.name===""?o.translate(D):a.vault.name}],toolbarActionButtons:[{...I().newSecretsValue,onclick:()=>{i.setLayoutAppForm(T,{...l.newDecrypted(),secretsVaultID:a.vaultID()})}}]}),s.redraw()},u.data,a.vaultID),s.route.param().id!==void 0&&a.vaultID(s.route.param().id)},onremove:()=>{c.end(!0),d.end(!0)},view:()=>s(P,{actions:[{icon:m.Edit,name:o.translate(v),onclick:async()=>{i.setLayoutAppForm(w,a.vault)},permitted:O.permitted(V.Secrets,!0)&&a.vaultID()!=="all",requireOnline:!0}],data:c(),editOnclick:e=>{i.setLayoutAppForm(T,e)},filters:[{icon:m.Tag,name:o.translate(k),onclick:e=>{a.tag()===e?a.tag(""):a.tag(e)},selected:()=>[a.tag()],value:l.tagNames()}],loaded:l.isLoaded(),search:{onsearch:e=>{a.search(e)},placeholder:o.translate(F)},sort:a.sort,tableColumns:[{name:o.translate(L),property:"name",render:h},...l.properties().map(e=>({formatter:t=>e==="TOTP"&&t.data[0].TOTP!==void 0?new C({secret:t.data[0].TOTP}).generate():t.data[0]!==void 0&&t.data[0][e]!==void 0?t.data[0][e]:"",name:e,noFilter:!0,property:e,type:G.Secret})),E()],tableColumnsNameEnabled:a.columns})}}export{U as SecretsValues};
