import{S as s,c as t,d as y,A as i,W as h,O as v,m as r,F as u,e as p,f as g,g as O,h as W,i as G,j as $,k as C,l as I,n as w,o as D,p as k,q,r as T,s as m,t as b,u as S,v as x,b as P,I as d,w as F,x as H,T as c,y as L,z as j,B as f,a as E,C as N}from"./index-09c2e996.js";import{F as R}from"./Filter-01c23926.js";import{G as B}from"./GetHelp-610c77dd.js";function U(){const e={authAccounts:s([]),columns:s({id:"",primaryAuthHouseholdID:"",emailAddress:"",created:"",lastActivity:""}),filter:"",form:{data:t.new(),deleteConfirm:!1,visible:!1},loaded:!1,page:1,total:0},o=new y;async function n(){let a=0;return e.page!==1&&(a=(e.page-1)*50),t.readAll(e.filter,a).then(l=>{N(l)||(e.authAccounts(l.dataValue),e.total=l.dataTotal,r.redraw())})}i.getSessionDisplay()<=1&&e.columns({authHouseholdID:"",emailAddress:""});const A=s.lift((a,l)=>R.array(a,l,{}),e.authAccounts,e.columns);return{oninit:async()=>(e.loaded=!1,i.setLayoutApp({...B(),breadcrumbs:[{name:t.translate(h)},{name:t.translate(v)}],toolbarActionButtons:[]}),r.route.param().filter!==void 0&&(e.filter=r.route.param().filter),r.route.param().page!==void 0&&(e.page=parseInt(r.route.param().page,10)),n().then(()=>{e.loaded=!0})),view:()=>[e.form.visible?r(P,{buttons:[{accent:!0,name:t.translate(w),onclick:async()=>D.delete(`${e.form.data.id}`).then(()=>{e.form.visible=!1}),permitted:!0,requireOnline:!0},{name:t.translate(k),onclick:async()=>t.createReset(e.form.data).catch(a=>{i.setLayoutAppAlert({message:a.message})}),permitted:!0,requireOnline:!0},{accent:!0,name:t.translate(q),onclick:async()=>new Promise(a=>(e.form.deleteConfirm=!0,a())),permitted:!e.form.deleteConfirm,requireOnline:!0},{name:t.translate(T),onclick:async()=>new Promise(a=>(e.form.deleteConfirm?e.form.deleteConfirm=!1:e.form.visible=!1,a())),permitted:!0,requireOnline:!1},{name:e.form.data.id===null?t.translate(m):t.translate(b),permitted:!e.form.deleteConfirm,requireOnline:!0,submit:!0},{accent:!0,name:t.translate(S),onclick:async()=>t.delete(e.form.data.id).then(async()=>(e.form.visible=!1,n())),permitted:e.form.deleteConfirm,requireOnline:!0}],onsubmit:async()=>e.form.data.id===null?(e.form.data.tosAccepted=!0,o.data(e.form.data),o.create(!1).then(async()=>(e.form.visible=!1,n()))):o.update(e.form.data).then(async()=>(e.form.visible=!1,n())),overlay:!0,title:{name:`${e.form.data.id===null?t.translate(m):t.translate(b)} ${t.translate(x)}`}},[r(u,{input:{oninput:a=>{e.form.data.emailAddress=a},required:!1,type:"text",value:e.form.data.emailAddress},name:t.translate(p),tooltip:t.translate(g)}),r(u,{input:{disabled:!0,oninput:()=>{},type:"text",value:O.values[e.form.data.oidcProviderType]},name:t.translate(W),tooltip:""}),r(u,{input:{oninput:a=>{e.form.data.password=a},type:"text",value:e.form.data.password},name:`${t.translate(G)} ${t.translate($)}`,tooltip:""}),r(C,{name:t.translate(I),onclick:()=>{e.form.data.verified=!e.form.data.verified},value:e.form.data.verified})]):[],r(E,{actions:[{icon:d.Invite,name:t.translate(m),onclick:async()=>{e.form.data=t.new(),e.form.visible=!0},permitted:!0,primary:!0,requireOnline:!0}],data:A(),editOnclick:a=>{e.form.data=a,e.form.visible=!0},filters:[],loaded:e.loaded,search:{onsearch:async a=>(e.filter=a,n()),placeholder:t.translate(F)},tableColumns:[{name:"ID",property:"id"},{linkFormatter:a=>`/admin/households?filter=${a.primaryAuthHouseholdID}`,name:`${t.translate(H)} ID`,property:"primaryAuthHouseholdID",type:c.Link},{name:t.translate(p),property:"emailAddress"},{name:t.translate(L),property:"created",type:c.Timestamp},{name:t.translate(j),property:"lastActivity",type:c.Timestamp}],tableColumnsNameEnabled:e.columns,title:{buttonLeft:e.page===1?void 0:{href:`/admin/accounts?page=${e.page-1}`,icon:d.Previous,iconOnly:!0,name:"previous",permitted:!0,requireOnline:!0},buttonRight:e.page*50>e.total?void 0:{href:`/admin/accounts?page=${e.page+1}`,icon:d.Next,iconOnly:!0,name:"next",permitted:!0,requireOnline:!0},name:e.authAccounts().length===0?`0 - 0 ${t.translate(f)} 0`:e.page===1?`1 - ${e.authAccounts().length} ${t.translate(f)} ${e.total}`:`${50*(e.page-1)+1} - ${50*(e.page-1)+e.authAccounts().length} ${t.translate(f)} ${e.total}`}})]}}export{U as AdminAccounts};
