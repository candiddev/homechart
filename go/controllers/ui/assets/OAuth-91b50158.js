import{A as n,m as t,c as a,eu as u,ev as l,ew as c,ex as m,dS as p,ey as h,ez as A,eA as d,Z as b,eB as g,o,eC as y,dt as w,b as _}from"./index-09c2e996.js";import{G as O}from"./GetHelp-610c77dd.js";const i=["","Amazon Alexa","Google Assistant"],W=()=>{let s=0;return{oninit:async()=>{n.toggleLayoutAppMenuOpen(!1);let e="";switch(t.route.param().redirect_uri!==void 0&&(e=t.route.param().redirect_uri),t.route.param().client_id){case"amazon_alexa":(e.startsWith("https://alexa.amazon.co.jp/spa/skill")||e.startsWith("https://pitangui.amazon.com/spa/skill")||e.startsWith("https://layla.amazon.com/spa/skill"))&&(s=1);break;case"google_assistant":e.startsWith("https://oauth-redirect.googleusercontent.com/r/")&&(s=2)}s===0&&(n.setLayoutAppAlert({message:a.translate(u)}),t.route.set("/home")),n.setLayoutApp({...O(),breadcrumbs:[{name:a.translate(l)}],toolbarActionButtons:[]})},view:()=>t(_,{buttons:[{accent:!0,name:a.translate(A),onclick:async()=>new Promise(e=>(t.route.set("/home"),e())),permitted:!0,requireOnline:!0},{name:a.translate(d),permitted:!0,requireOnline:!0,submit:!0}],onsubmit:async()=>{const e=b.now();e.addDays(3650);const r=new g;return r.data({...o.new(),authAccountID:o.data().authAccountID,expires:e.toString(),name:i[s],userAgent:y}),r.create().then(()=>{window.location.href=`${t.route.param().redirect_uri}#access_token=${w.data().cloud?"":a.data().primaryAuthHouseholdID}_${r.data().id}_${r.data().key}&token_type=bearer&state=${t.route.param().state}`})}},[t("div.OAuth",[t(c),t("p.OAuth__title#oauth-title",[t("span",i[s]),t("br"),a.translate(m)]),t(p,{value:`${a.translate(h)} [Settings > Sessions](/settings/sessions).`})])])}};export{W as OAuth};
