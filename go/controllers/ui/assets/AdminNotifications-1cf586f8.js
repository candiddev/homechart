import{V as l,A as i,c as e,X as S,Y as T,Z as d,C as A,_ as h,$ as M,S as m,a0 as v,W as C,a1 as D,m as n,k as P,a2 as w,F as o,a3 as N,a4 as c,a5 as j,a6 as f,q as I,r as O,s as W,t as p,u as F,a7 as $,b as g,y as k,T as b,a as G,a8 as q}from"./index-09c2e996.js";import{F as x}from"./Filter-01c23926.js";import{G as L}from"./GetHelp-610c77dd.js";const r={create:async t=>l.create("/api/v1/notifications",t).then(()=>{i.setLayoutAppAlert({message:e.translate(S)})}),delete:async t=>l.delete(`/api/v1/notifications/${t}`).then(()=>{i.setLayoutAppAlert({message:e.translate(T)})}),inResponse:t=>t.dataType==="Notifications",is:t=>t!==null,new:()=>{const t=d.now();return t.addMinutes(10),{authAccountID:null,bodySMTP:"",created:null,id:null,newsletter:!1,sendAfter:t.toString(),subjectSMTP:"",toSMTP:""}},read:async()=>l.read("/api/v1/notifications",{}).then(t=>A(t)?t:r.inResponse(t)?t.dataValue:h),update:async t=>l.update(`/api/v1/notifications/${t.id}`,t).then(()=>{i.setLayoutAppAlert({message:e.translate(M)})})};function B(){const t={columns:m({authAccountID:"",subjectFCM:"",subjectSMTP:"",created:"",sendAfter:"",type:""}),form:{data:r.new(),deleteConfirm:!1,visible:!1},loaded:!1,notifications:m([])};async function s(){return r.read().then(a=>{A(a)?t.notifications([]):t.notifications(q(a)),n.redraw()})}i.getSessionDisplay()<=v.Small&&t.columns({authAccountID:"",subjectFCM:"",subjectSMTP:""});const y=m.lift((a,u)=>x.array(a,u,{}),t.notifications,t.columns);return{oninit:async()=>(t.loaded=!1,i.setLayoutApp({...L(),breadcrumbs:[{name:e.translate(C)},{name:e.translate(D)}],toolbarActionButtons:[{name:"Notification",onclick:()=>{t.form.data=r.new(),t.form.visible=!0},permitted:!0,requireOnline:!0}]}),s().then(()=>{t.loaded=!0})),view:()=>[t.form.visible?n(g,{buttons:[{accent:!0,name:e.translate(I),onclick:async()=>new Promise(a=>(t.form.deleteConfirm=!0,a())),permitted:!t.form.deleteConfirm&&t.form.data.id!==null,requireOnline:!0},{name:e.translate(O),onclick:async()=>new Promise(a=>(t.form.deleteConfirm?t.form.deleteConfirm=!1:t.form.visible=!1,a())),permitted:!0,requireOnline:!1},{name:t.form.data.id===null?e.translate(W):e.translate(p),permitted:!t.form.deleteConfirm,requireOnline:!0,submit:!0},{accent:!0,name:e.translate(F),onclick:async()=>r.delete(t.form.data.id).then(async()=>(t.form.visible=!1,s())),permitted:t.form.deleteConfirm,requireOnline:!0}],onsubmit:async()=>t.form.data.id===null?r.create(t.form.data).then(async()=>(t.form.visible=!1,s())):r.update(t.form.data).then(async()=>(t.form.visible=!1,s())),overlay:!0,title:{name:`${e.translate(p)} ${e.translate($)}`}},[n(P,{name:e.translate(w),onclick:()=>{t.form.data.newsletter=!t.form.data.newsletter,t.form.data.authAccountID=null},value:t.form.data.newsletter}),t.form.data.newsletter?[]:n(o,{input:{oninput:a=>{t.form.data.authAccountID=a===""?null:a},type:"text",value:t.form.data.authAccountID===null?"":t.form.data.authAccountID},name:"AuthAccountID",tooltip:""}),n(o,{input:{oninput:a=>{t.form.data.toSMTP=a},type:"text",value:t.form.data.toSMTP},name:`${e.translate(N)} SMTP`,tooltip:""}),n(o,{input:{oninput:a=>{t.form.data.subjectSMTP=a},type:"text",value:t.form.data.subjectSMTP},name:`${e.translate(c)} SMTP`,tooltip:""}),n(o,{name:`${e.translate(j)} SMTP`,textArea:{oninput:a=>{t.form.data.bodySMTP=a},value:t.form.data.bodySMTP},tooltip:""}),n(o,{input:{disabled:t.form.data.newsletter,oninput:a=>{const u=new Date(a);t.form.data.sendAfter=u.toISOString()},type:"datetime-local",value:t.form.data.newsletter?d.fromString(t.form.data.sendAfter).toPrettyString(e.data().preferences.formatDateOrder,e.data().preferences.formatDateSeparator,e.data().preferences.formatTime24):t.form.data.sendAfter===""||t.form.data.sendAfter===null?"":d.fromString(t.form.data.sendAfter).toHTMLDate()},name:e.translate(f),tooltip:""})]):[],n(G,{actions:[],data:y(),editOnclick:a=>{t.form.data=a,t.form.visible=!0},filters:[],loaded:t.loaded,tableColumns:[{name:"AuthAccountID",property:"authAccountID"},{name:`${e.translate(c)} SMTP`,property:"subjectSMTP"},{name:`${e.translate(c)} FCM`,property:"subjectFCM"},{name:e.translate(k),property:"created",type:b.Timestamp},{name:e.translate(f),property:"sendAfter",type:b.Timestamp}],tableColumnsNameEnabled:t.columns})]}}export{B as AdminNotifications};
