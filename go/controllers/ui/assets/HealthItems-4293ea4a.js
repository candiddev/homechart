import{S as l,c as e,m as s,dC as i,bE as S,A as p,b$ as w,dD as C,dE as G,ab as c,I as D,dF as L,dG as k,ah as b,ai as f,dH as g,dI as v,D as u,dJ as W,dK as j,dL as M,dM as E,af as F,dN as T,a as $,am as x,b2 as A}from"./index-09c2e996.js";import{F as N}from"./Filter-01c23926.js";import{G as B}from"./GetHelp-610c77dd.js";function K(){const t={columns:l({name:"",totalCorrelations:""}),id:l(e.data().id),output:l(!1),search:l(""),sort:l({invert:!1,property:"name"})};let m;function y(){let a=[];return{oninit:o=>{a=Object.keys(o.attrs.correlations).sort((r,n)=>o.attrs.correlations[n]-o.attrs.correlations[r]).map(r=>{const n=i.findID(r);return{color:n.color,id:r,name:`${n.name} (${o.attrs.correlations[r]})`}})},view:o=>s("div",{style:{"align-items":"flex-start",display:"flex","flex-direction":"column"}},[o.attrs.name,s(x,{name:"tags",onclick:()=>{s.route.set(`/health/items?type=${t.output()?"inputs":"outputs"}&id=${u.findMember(t.id()).id}`,{},{state:{key:Date.now()}})},selected:()=>a.map(r=>r.id),value:a})])}}return{oninit:async()=>{A.spanStart("HealthItems"),s.route.param().id!==void 0&&t.id(s.route.param().id),s.route.param().type==="outputs"&&t.output(!0),m=l.lift((a,o,r,n,H,h,I)=>{let d=i.findAuthAccountID(n,H);return h!==""&&(d=d.filter(O=>O.name.toLowerCase().includes(h.toLowerCase()))),s.redraw(),N.array(d,r,I)},i.data,S.data,t.columns,t.id,t.output,t.search,t.sort),p.setLayoutApp({...B("health"),breadcrumbs:[{link:"/health/items",name:e.translate(w)},{name:t.output()?e.translate(C):e.translate(G)}],toolbarActionButtons:[c().newHealthItemInput,c().newHealthItemOutput,c().newHealthLogs]}),A.spanEnd("HealthItems")},onremove:()=>{m.end(!0)},view:()=>s($,{actions:[{icon:D.Refresh,name:e.translate(L),onclick:async()=>{await i.init(t.id()),p.setLayoutAppAlert({message:e.translate(k)})},permitted:b.permitted(f.Health,!0),requireOnline:!0}],data:m(),editOnclick:a=>{p.setLayoutAppForm(g,a)},filters:[{name:e.translate(v),onclick:a=>{t.id(u.findMember(a).id)},selected:()=>[u.findMember(t.id()).name],value:b.permitted(f.Auth,!0,e.data().primaryAuthHouseholdID)&&u.membersChildren().length>0?u.findMemberNames(e.data().primaryAuthHouseholdID,!0):[]},{name:e.translate(W),onclick:a=>{t.output(a==="output")},selected:()=>[t.output()?"output":"input"],value:[{id:"input",name:e.translate(j)},{id:"output",name:e.translate(M)}]}],loaded:i.isLoaded(),search:{onsearch:a=>{t.search(a)},placeholder:e.translate(E)},sort:t.sort,tableColumns:[{name:e.translate(F),property:"name",render:y},{name:e.translate(T),property:"totalCorrelations"}],tableColumnsNameEnabled:t.columns})}}export{K as HealthItems};
