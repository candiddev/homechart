import{S as s,eh as o,ei as u,m as r,c as a,al as p,x as f,A as g,d7 as S,I as l,ej as k,ah as b,ai as h,cy as w,ad as C,ek as I,af as G,el as L,Z as O,em as T,ak as W,a as j,am as x}from"./index-09c2e996.js";import{F}from"./Filter-01c23926.js";import{T as H}from"./TableColumnHousehold-f6fe7c15.js";import{G as $}from"./GetHelp-610c77dd.js";function U(){const e={columns:s({name:"",parentID:"",updated:""}),deleted:s(!1),filter:s(""),search:s(""),sort:s({invert:!1,property:"name"}),tag:s(""),tags:[],title:"All"};let n;function y(){return{view:t=>r("div",{style:{"align-items":"flex-start",display:"flex","flex-direction":"column"}},[t.attrs.name,r(x,{icon:l.Tag,name:"tags",onclick:i=>{e.tag()===i?e.tag(""):e.tag(i)},selected:()=>[e.tag()],small:!0,value:t.attrs.tags})])}}return{oninit:async()=>{switch(n=s.lift((t,i,v,N,A,d,P,D)=>{const m=o.filter(t,N,A,d,D,c=>c.name.toLowerCase().includes(d.toLowerCase())||u.findNotesPageIDLatest(c.id).body.toLowerCase().includes(d.toLowerCase()));return e.tags=m.tags,F.array(m.data,v,P)},o.data,u.data,e.columns,e.deleted,e.filter,e.search,e.sort,e.tag),r.route.param().tag){case void 0:break;case"household":e.filter("household"),e.title=a.translate(f);break;case"personal":e.filter("personal"),e.title=a.translate(p);break;default:e.tag(r.route.param().tag),e.title=e.tag()}r.route.param().deleted!==void 0&&e.deleted(!0),g.setLayoutApp({...$("notes"),breadcrumbs:[{name:a.translate(S)}],toolbarActionButtons:[{icon:l.Notes,name:a.translate(k),onclick:()=>{r.route.set(`/notes/${e.filter()===""?"personal":e.filter()}/new?edit`)},permitted:b.permitted(h.Notes,!0,a.data().primaryAuthHouseholdID),requireOnline:!0}]})},onremove:()=>{n.end(!0)},view:()=>[r(j,{actions:[{icon:l.Delete,name:a.translate(w),onclick:async()=>new Promise(t=>(e.deleted(!e.deleted()),e.tag(""),t())),permitted:b.permitted(h.Cook,!0),requireOnline:!1,secondary:e.deleted()}],data:n(),editOnclick:t=>{t.authAccountID===null?r.route.set(`/notes/household/${t.id}`):r.route.set(`/notes/personal/${t.id}`)},filters:[{icon:l.Tag,name:a.translate(C),onclick:t=>{e.tag()===t?e.tag(""):e.tag(t)},selected:()=>[e.tag()],value:e.tags}],loaded:o.isLoaded(),search:{onsearch:t=>{e.search(t)},placeholder:a.translate(I)},sort:e.sort,tableColumns:[{name:a.translate(G),noFilter:!0,property:"name",render:y},{formatter:t=>o.findID(t.parentID).name,name:a.translate(L),noFilter:!0,property:"parentID"},{formatter:t=>g.formatCivilDate(O.fromString(u.findNotesPageIDLatest(t.id).updated).toCivilDate().toJSON()),name:a.translate(T),noFilter:!0,property:"updated"},H()],tableColumnsNameEnabled:e.columns,title:{tabs:[{active:e.filter()==="",href:"/notes",name:a.translate(W)},{active:e.filter()==="personal",href:"/notes/personal",name:a.translate(p)},{active:e.filter()==="household",href:"/notes/household",name:a.translate(f)}]}})]}}export{U as NotesPages};
